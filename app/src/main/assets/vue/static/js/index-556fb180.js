import{r as de,j as fe,B as ge,I as R,k as me,e as be,F as he,C as ye,l as ve}from"./index-ac3d55c5.js";import{L as Se}from"./index-07fcaa1e.js";import{p as D,g as xe,s as Ce,u as ke,a as Ie,r as Te}from"./use-id-df39a5bc.js";import{c as K,P as Y,a as b,n as L,d as J,e as s,j as G,a1 as Pe,R as we,a2 as Be,m as Ve,u as Ee,g as Me,r as j,b as E,L as Re,H as Le,D as Ae,I as M,E as Oe,i as _,a3 as q,a4 as ze,O as _e,a0 as Ne}from"./index-731042c6.js";const[De,k]=K("button"),Fe=Y({},de,{tag:b("button"),text:String,icon:String,type:b("default"),size:b("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:b("button"),loadingSize:L,loadingText:String,loadingType:String,iconPosition:b("left")});var $e=J({name:De,props:Fe,emits:["click"],setup(e,{emit:n,slots:a}){const c=fe(),l=()=>a.loading?a.loading():s(Se,{size:e.loadingSize,type:e.loadingType,class:k("loading")},null),u=()=>{if(e.loading)return l();if(a.icon)return s("div",{class:k("icon")},[a.icon()]);if(e.icon)return s(R,{name:e.icon,class:k("icon"),classPrefix:e.iconPrefix},null)},I=()=>{let i;if(e.loading?i=e.loadingText:i=a.default?a.default():e.text,i)return s("span",{class:k("text")},[i])},d=()=>{const{color:i,plain:S}=e;if(i){const m={color:S?i:"white"};return S||(m.background=i),i.includes("gradient")?m.border=0:m.borderColor=i,m}},h=i=>{e.loading?D(i):e.disabled||(n("click",i),c())};return()=>{const{tag:i,type:S,size:m,block:A,round:x,plain:P,square:w,loading:T,disabled:B,hairline:y,nativeType:O,iconPosition:C}=e,z=[k([S,m,{plain:P,block:A,round:x,square:w,loading:T,disabled:B,hairline:y}]),{[ge]:y}];return s(i,{type:O,class:z,style:d(),disabled:B,onClick:h},{default:()=>[s("div",{class:k("content")},[C==="left"&&u(),I(),C==="right"&&u()])]})}}});const nt=G($e);function We(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function je(e,n){return!(n.required&&We(e)||n.pattern&&!n.pattern.test(String(e)))}function qe(e,n){return new Promise(a=>{const c=n.validator(e,n);if(we(c)){c.then(a);return}a(c)})}function H(e,n){const{message:a}=n;return Be(a)?a(e,n):a||""}function He({target:e}){e.composing=!0}function U({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Ue(e,n){const a=xe();e.style.height="auto";let c=e.scrollHeight;if(Pe(n)){const{maxHeight:l,minHeight:u}=n;l!==void 0&&(c=Math.min(c,l)),u!==void 0&&(c=Math.max(c,u))}c&&(e.style.height=`${c}px`,Ce(a))}function Ke(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function N(e){return[...e].length}function Ye(e,n){return[...e].slice(0,n).join("")}const[Je,g]=K("field"),Ge={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:L,formatter:Function,clearIcon:b("clear"),modelValue:Ve(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:b("focus"),formatTrigger:b("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Qe=Y({},me,Ge,{rows:L,type:b("text"),rules:Array,autosize:[Boolean,Object],labelWidth:L,labelClass:Ee,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Xe=J({name:Je,props:Qe,emits:["blur","focus","clear","keypress","click-input","end-validate","start-validate","click-left-icon","click-right-icon","update:modelValue"],setup(e,{emit:n,slots:a}){const c=ke(),l=Me({status:"unvalidated",focused:!1,validateMessage:""}),u=j(),I=j(),{parent:d}=be(he),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},i=t=>{if(_(e[t]))return e[t];if(d&&_(d.props[t]))return d.props[t]},S=E(()=>{const t=i("readonly");if(e.clearable&&!t){const r=h()!=="",o=e.clearTrigger==="always"||e.clearTrigger==="focus"&&l.focused;return r&&o}return!1}),m=E(()=>I.value&&a.input?I.value():e.modelValue),A=t=>t.reduce((r,o)=>r.then(()=>{if(l.status==="failed")return;let{value:f}=m;if(o.formatter&&(f=o.formatter(f,o)),!je(f,o)){l.status="failed",l.validateMessage=H(f,o);return}if(o.validator)return qe(f,o).then(v=>{v&&typeof v=="string"?(l.status="failed",l.validateMessage=v):v===!1&&(l.status="failed",l.validateMessage=H(f,o))})}),Promise.resolve()),x=()=>{l.status="unvalidated",l.validateMessage=""},P=()=>n("end-validate",{status:l.status}),w=(t=e.rules)=>new Promise(r=>{x(),t?(n("start-validate"),A(t).then(()=>{l.status==="failed"?(r({name:e.name,message:l.validateMessage}),P()):(l.status="passed",r(),P())})):r()}),T=t=>{if(d&&e.rules){const{validateTrigger:r}=d.props,o=q(r).includes(t),f=e.rules.filter(v=>v.trigger?q(v.trigger).includes(t):o);f.length&&w(f)}},B=t=>{const{maxlength:r}=e;if(_(r)&&N(t)>r){const o=h();return o&&N(o)===+r?o:Ye(t,+r)}return t},y=(t,r="onChange")=>{if(t=B(t),e.type==="number"||e.type==="digit"){const o=e.type==="number";t=ze(t,o,o)}e.formatter&&r===e.formatTrigger&&(t=e.formatter(t)),u.value&&u.value.value!==t&&(u.value.value=t),t!==e.modelValue&&n("update:modelValue",t)},O=t=>{t.target.composing||y(t.target.value)},C=()=>{var t;return(t=u.value)==null?void 0:t.blur()},z=()=>{var t;return(t=u.value)==null?void 0:t.focus()},V=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&Ue(t,e.autosize)},Q=t=>{l.focused=!0,n("focus",t),M(V),i("readonly")&&C()},X=t=>{i("readonly")||(l.focused=!1,y(h(),"onBlur"),n("blur",t),T("onBlur"),M(V),Te())},F=t=>n("click-input",t),Z=t=>n("click-left-icon",t),p=t=>n("click-right-icon",t),ee=t=>{D(t),n("update:modelValue",""),n("clear",t)},$=E(()=>{if(typeof e.error=="boolean")return e.error;if(d&&d.props.showError&&l.status==="failed")return!0}),te=E(()=>{const t=i("labelWidth");if(t)return{width:Re(t)}}),ne=t=>{t.keyCode===13&&(!(d&&d.props.submitOnEnter)&&e.type!=="textarea"&&D(t),e.type==="search"&&C()),n("keypress",t)},W=()=>e.id||`${c}-input`,ae=()=>l.status,ie=()=>{const t=g("control",[i("inputAlign"),{error:$.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return s("div",{class:t,onClick:F},[a.input()]);const r={id:W(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:i("disabled"),readonly:i("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${c}-label`:void 0,onBlur:X,onFocus:Q,onInput:O,onClick:F,onChange:U,onKeypress:ne,onCompositionend:U,onCompositionstart:He};return e.type==="textarea"?s("textarea",r,null):s("input",_e(Ke(e.type),r),null)},re=()=>{const t=a["left-icon"];if(e.leftIcon||t)return s("div",{class:g("left-icon"),onClick:Z},[t?t():s(R,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},oe=()=>{const t=a["right-icon"];if(e.rightIcon||t)return s("div",{class:g("right-icon"),onClick:p},[t?t():s(R,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},le=()=>{if(e.showWordLimit&&e.maxlength){const t=N(h());return s("div",{class:g("word-limit")},[s("span",{class:g("word-num")},[t]),Ne("/"),e.maxlength])}},se=()=>{if(d&&d.props.showErrorMessage===!1)return;const t=e.errorMessage||l.validateMessage;if(t){const r=a["error-message"],o=i("errorMessageAlign");return s("div",{class:g("error-message",o)},[r?r({message:t}):t])}},ce=()=>{const t=i("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return s("label",{id:`${c}-label`,for:W()},[e.label+t])},ue=()=>[s("div",{class:g("body")},[ie(),S.value&&s(R,{name:e.clearIcon,class:g("clear"),onTouchstart:ee},null),oe(),a.button&&s("div",{class:g("button")},[a.button()])]),le(),se()];return Ie({blur:C,focus:z,validate:w,formValue:m,resetValidation:x,getValidationStatus:ae}),Le(ve,{customValue:I,resetValidation:x,validateWithTrigger:T}),Ae(()=>e.modelValue,()=>{y(h()),x(),T("onChange"),M(V)}),Oe(()=>{y(h(),e.formatTrigger),M(V)}),()=>{const t=i("disabled"),r=i("labelAlign"),o=ce(),f=re();return s(ye,{size:e.size,icon:e.leftIcon,class:g({error:$.value,disabled:t,[`label-${r}`]:r}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:te.value,valueClass:g("value"),titleClass:[g("label",[r,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:f?()=>f:null,title:o?()=>o:null,value:ue,extra:a.extra})}}});const at=G(Xe);export{nt as B,at as F};
